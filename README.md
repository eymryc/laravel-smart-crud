# Laravel Smart CRUD

[![Latest Version on Packagist](https://img.shields.io/packagist/v/rouangni/laravel-smart-crud.svg?style=flat-square)](https://packagist.org/packages/rouangni/laravel-smart-crud)
[![Software License](https://img.shields.io/badge/license-MIT-brightgreen.svg?style=flat-square)](LICENSE.md)
[![Total Downloads](https://img.shields.io/packagist/dt/rouangni/laravel-smart-crud.svg?style=flat-square)](https://packagist.org/packages/rouangni/laravel-smart-crud)

Un package Laravel moderne pour g√©n√©rer automatiquement des op√©rations CRUD compl√®tes avec s√©paration API/Web et organisation par espaces de noms.

## ‚ú® Fonctionnalit√©s

- üöÄ **G√©n√©ration rapide** de CRUD complets
- üîÑ **S√©paration API/Web** avec espaces de noms d√©di√©s
- üìÅ **Organisation par entit√©** - chaque mod√®le dans son propre dossier
- üéØ **Architecture moderne** avec Services, Repositories, DTOs
- üîß **Configurable** - personnalisez stubs et configurations
- üìä **Support du versioning API** (V1, V2, etc.)
- üé® **Templates personnalisables** via publication des stubs

## üì¶ Installation

```bash
composer require rouangni/laravel-smart-crud
```

### Publication des configurations (optionnel)

```bash
# Publier la configuration
php artisan vendor:publish --tag=smart-crud-config

# Publier les stubs pour personnalisation
php artisan vendor:publish --tag=smart-crud-stubs
```

## üöÄ Utilisation

### Commande de base

```bash
php artisan make:smart-crud {Model} [options]
```

### Options disponibles

| Option | Description |
|--------|-------------|
| `--api` | G√©n√®re les fichiers API |
| `--web` | G√©n√®re les fichiers Web |
| `--version=V1` | Sp√©cifie la version API (d√©faut: V1) |
| `--force` | √âcrase les fichiers existants |
| `--skip-common` | Ignore les fichiers communs (Service, Repository, etc.) |
| `--skip-routes` | Ignore la g√©n√©ration des routes |
| `--skip-views` | Ignore la g√©n√©ration des vues (Web uniquement) |
| `--dry-run` | Affiche ce qui sera g√©n√©r√© sans cr√©er les fichiers |

### Exemples d'utilisation

```bash
# G√©n√©ration API uniquement
php artisan make:smart-crud Product --api

# G√©n√©ration Web uniquement  
php artisan make:smart-crud Product --web

# G√©n√©ration API + Web
php artisan make:smart-crud Product --api --web

# Avec version API sp√©cifique
php artisan make:smart-crud Product --api --version=V2

# Pr√©visualisation sans g√©n√©ration
php artisan make:smart-crud Product --api --dry-run

# Forcer la r√©g√©n√©ration
php artisan make:smart-crud Product --api --force

# Ignorer les fichiers communs (si d√©j√† existants)
php artisan make:smart-crud Product --api --skip-common
```

## üìÅ Structure g√©n√©r√©e

### Pour `Product` avec `--api`

```
App/
‚îú‚îÄ‚îÄ Http/
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Api/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ V1/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ Product/
‚îÇ   ‚îÇ               ‚îî‚îÄ‚îÄ ProductController.php
‚îÇ   ‚îú‚îÄ‚îÄ Requests/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Api/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ V1/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ Product/
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ StoreProductRequest.php
‚îÇ   ‚îÇ               ‚îî‚îÄ‚îÄ UpdateProductRequest.php
‚îÇ   ‚îî‚îÄ‚îÄ Resources/
‚îÇ       ‚îî‚îÄ‚îÄ Api/
‚îÇ           ‚îî‚îÄ‚îÄ V1/
‚îÇ               ‚îî‚îÄ‚îÄ Product/
‚îÇ                   ‚îú‚îÄ‚îÄ ProductResource.php
‚îÇ                   ‚îî‚îÄ‚îÄ ProductCollection.php
‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îî‚îÄ‚îÄ Product/
‚îÇ       ‚îî‚îÄ‚îÄ ProductService.php
‚îú‚îÄ‚îÄ Repositories/
‚îÇ   ‚îî‚îÄ‚îÄ Product/
‚îÇ       ‚îú‚îÄ‚îÄ ProductRepository.php
‚îÇ       ‚îî‚îÄ‚îÄ Contracts/
‚îÇ           ‚îî‚îÄ‚îÄ ProductRepositoryInterface.php
‚îú‚îÄ‚îÄ DTOs/
‚îÇ   ‚îî‚îÄ‚îÄ Product/
‚îÇ       ‚îú‚îÄ‚îÄ ProductCreateDTO.php
‚îÇ       ‚îú‚îÄ‚îÄ ProductUpdateDTO.php
‚îÇ       ‚îî‚îÄ‚îÄ ProductFilterDTO.php
‚îî‚îÄ‚îÄ Exceptions/
    ‚îî‚îÄ‚îÄ Product/
        ‚îî‚îÄ‚îÄ ProductException.php
```

### Pour `Product` avec `--web`

```
App/
‚îú‚îÄ‚îÄ Http/
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Web/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Product/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ ProductController.php
‚îÇ   ‚îî‚îÄ‚îÄ Requests/
‚îÇ       ‚îî‚îÄ‚îÄ Web/
‚îÇ           ‚îî‚îÄ‚îÄ Product/
‚îÇ               ‚îú‚îÄ‚îÄ StoreProductRequest.php
‚îÇ               ‚îî‚îÄ‚îÄ UpdateProductRequest.php
‚îî‚îÄ‚îÄ resources/
    ‚îî‚îÄ‚îÄ views/
        ‚îî‚îÄ‚îÄ products/
            ‚îú‚îÄ‚îÄ index.blade.php
            ‚îú‚îÄ‚îÄ create.blade.php
            ‚îú‚îÄ‚îÄ edit.blade.php
            ‚îî‚îÄ‚îÄ show.blade.php
```

## üéØ Fonctionnalit√©s d√©taill√©es

### 1. **Contr√¥leurs intelligents**

Les contr√¥leurs g√©n√©r√©s incluent :
- ‚úÖ Gestion d'erreurs compl√®te
- ‚úÖ Injection de d√©pendances
- ‚úÖ Responses API standardis√©es
- ‚úÖ Validation automatique
- ‚úÖ Documentation inline

### 2. **Architecture en couches**

```
Controller ‚Üí Service ‚Üí Repository ‚Üí Model
     ‚Üì         ‚Üì         ‚Üì
   Request   DTO     Interface
```

### 3. **DTOs (Data Transfer Objects)**

- **CreateDTO** : Validation et transformation des donn√©es de cr√©ation
- **UpdateDTO** : Validation et transformation des donn√©es de modification  
- **FilterDTO** : Gestion des filtres de recherche et pagination

### 4. **Traits utiles inclus**

#### ApiResponseTrait
```php
// Responses standardis√©es
$this->successResponse($data, 'Message');
$this->errorResponse('Error', 400);
$this->createdResponse($data);
$this->notFoundResponse();
```

#### BaseRepositoryTrait
```php
// M√©thodes de base pour tous les repositories
$repository->all($filters, $relations);
$repository->paginate(15, $filters);
$repository->findBy('status', 'active');
```

## ‚öôÔ∏è Configuration

Le fichier de configuration `config/smart-crud.php` permet de personnaliser :

```php
return [
    // Version API par d√©faut
    'default_api_version' => 'V1',
    
    // Espaces de noms
    'namespaces' => [
        'controllers' => [
            'api' => 'App\\Http\\Controllers\\Api',
            'web' => 'App\\Http\\Controllers\\Web',
        ],
        // ...
    ],
    
    // Chemins de g√©n√©ration
    'paths' => [
        'controllers' => [
            'api' => 'Http/Controllers/Api',
            'web' => 'Http/Controllers/Web',
        ],
        // ...
    ],
    
    // Configuration des stubs
    'stubs' => [
        'api' => [
            'controller' => 'Api/controller.api.stub',
            // ...
        ],
    ],
];
```

## üé® Personnalisation des templates

1. **Publier les stubs** :
```bash
php artisan vendor:publish --tag=smart-crud-stubs
```

2. **Modifier les templates** dans `resources/stubs/smart-crud/`

3. **Variables disponibles dans les stubs** :
- `{{ model }}` - Nom du mod√®le (ex: Product)
- `{{ modelVariable }}` - Variable camelCase (ex: product)
- `{{ modelPlural }}` - Nom pluriel (ex: Products)
- `{{ modelKebab }}` - Format kebab-case (ex: product)
- `{{ namespace }}` - Namespace de la classe
- `{{ class }}` - Nom de la classe

## üîå Int√©gration dans vos projets

### 1. Enregistrer les routes

Dans `app/Providers/RouteServiceProvider.php` :

```php
public function boot()
{
    // Routes API
    Route::prefix('api')
        ->middleware('api')
        ->group(function () {
            // Inclure vos routes API g√©n√©r√©es
            $this->loadRoutesFrom(base_path('routes/api/v1/product.php'));
        });

    // Routes Web
    Route::middleware('web')
        ->group(function () {
            // Inclure vos routes Web g√©n√©r√©es
            $this->loadRoutesFrom(base_path('routes/web/product.php'));
        });
}
```

### 2. Lier les interfaces aux impl√©mentations

Dans `app/Providers/AppServiceProvider.php` :

```php
public function register()
{
    // Lier les repository interfaces
    $this->app->bind(
        \App\Repositories\Product\Contracts\ProductRepositoryInterface::class,
        \App\Repositories\Product\ProductRepository::class
    );
}
```

### 3. Configurer les models

Assurez-vous que vos models utilisent les traits appropri√©s :

```php
use App\Models\Model;
use Illuminate\Database\Eloquent\Factories\HasFactory;

class Product extends Model
{
    use HasFactory;

    protected $fillable = [
        'name',
        'description',
        'price',
        // ... autres champs
    ];

    protected $casts = [
        'price' => 'decimal:2',
        // ... autres casts
    ];
}
```

## üö¶ Endpoints g√©n√©r√©s

### API Endpoints (exemple pour Product)

```
GET    /api/v1/products         # Liste des produits
POST   /api/v1/products         # Cr√©er un produit
GET    /api/v1/products/{id}    # Afficher un produit
PUT    /api/v1/products/{id}    # Modifier un produit
DELETE /api/v1/products/{id}    # Supprimer un produit
```

### Web Routes (exemple pour Product)

```
GET    /products                # Liste des produits
GET    /products/create         # Formulaire de cr√©ation
POST   /products                # Cr√©er un produit
GET    /products/{id}           # Afficher un produit
GET    /products/{id}/edit      # Formulaire d'√©dition
PUT    /products/{id}           # Modifier un produit
DELETE /products/{id}           # Supprimer un produit
```

## üìù Exemples d'usage

### Contr√¥leur API g√©n√©r√©

```php
<?php

namespace App\Http\Controllers\Api\V1\Product;

use App\Http\Controllers\Controller;
use App\Services\Product\ProductService;
use Rouangni\SmartCrud\Traits\ApiResponseTrait;

class ProductController extends Controller
{
    use ApiResponseTrait;

    public function __construct(
        protected ProductService $productService
    ) {}

    public function index(Request $request): JsonResponse
    {
        $filterDTO = new ProductFilterDTO($request->all());
        $products = $this->productService->getAll($filterDTO);

        return $this->successResponse(
            new ProductCollection($products),
            'Products retrieved successfully'
        );
    }

    // ... autres m√©thodes
}
```

### Service g√©n√©r√©

```php
<?php

namespace App\Services\Product;

use App\Repositories\Product\Contracts\ProductRepositoryInterface;

class ProductService
{
    public function __construct(
        protected ProductRepositoryInterface $productRepository
    ) {}

    public function getAll(ProductFilterDTO $filterDTO)
    {
        $filters = $filterDTO->toArray();

        if ($filterDTO->paginate) {
            return $this->productRepository->paginate(
                $filterDTO->perPage ?? 15,
                $filters
            );
        }

        return $this->productRepository->all($filters);
    }

    // ... autres m√©thodes
}
```

## üß™ Tests

Le package inclut des tests complets :

```bash
# Lancer les tests
composer test

# Tests avec couverture
composer test-coverage
```

## ü§ù Contribution

Les contributions sont les bienvenues ! Veuillez lire [CONTRIBUTING.md](CONTRIBUTING.md) pour les d√©tails.

### D√©veloppement local

```bash
# Cloner le repository
git clone https://github.com/rouangni/laravel-smart-crud.git

# Installer les d√©pendances
composer install

# Lancer les tests
composer test
```

## üìÑ License

Ce package est open-source sous [licence MIT](LICENSE.md).

## üîÑ Changelog

Voir [CHANGELOG.md](CHANGELOG.md) pour l'historique des versions.

## üí° Roadmap

- [ ] Support des relations automatiques
- [ ] G√©n√©ration de tests automatiques
- [ ] Interface graphique pour la configuration
- [ ] Support des APIs GraphQL
- [ ] Templates pour diff√©rents frameworks CSS

## üÜò Support

- üìö [Documentation compl√®te](https://github.com/rouangni/laravel-smart-crud/wiki)
- üêõ [Signaler un bug](https://github.com/rouangni/laravel-smart-crud/issues)
- üí¨ [Discussions](https://github.com/rouangni/laravel-smart-crud/discussions)

---

Fait avec ‚ù§Ô∏è pour la communaut√© Laravel